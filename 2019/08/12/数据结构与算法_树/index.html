<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;example.com&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="树 树的定义：树是一种数据结构，它是由n(n&gt;&#x3D;1)个有限结点组成的一个具有层次关系的集合。把它叫做“树”是因为它看起来像一棵倒挂的树，也就是说它是根朝上，而叶朝下的。它具有以下的特点：每个结点有零个或多个子结点；没有父结点的结点称为根结点；每一个非根结点有且只有一个父结点；除了根结点外，每个子结点可以分为多个不相交的子树； 树的大小：节点的数量； 树中一个节点的深度：该节点到根节点的路径上">
<meta property="og:type" content="article">
<meta property="og:title" content="二叉搜索树、平衡二叉树、红黑二叉树">
<meta property="og:url" content="http://example.com/2019/08/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95_%E6%A0%91/index.html">
<meta property="og:site_name" content="Saltedfish">
<meta property="og:description" content="树 树的定义：树是一种数据结构，它是由n(n&gt;&#x3D;1)个有限结点组成的一个具有层次关系的集合。把它叫做“树”是因为它看起来像一棵倒挂的树，也就是说它是根朝上，而叶朝下的。它具有以下的特点：每个结点有零个或多个子结点；没有父结点的结点称为根结点；每一个非根结点有且只有一个父结点；除了根结点外，每个子结点可以分为多个不相交的子树； 树的大小：节点的数量； 树中一个节点的深度：该节点到根节点的路径上">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdn.net/20170429162537906?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvanl5MzA1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="article:published_time" content="2019-08-12T14:25:15.000Z">
<meta property="article:modified_time" content="2021-01-27T14:13:06.000Z">
<meta property="article:author" content="Saltedfish">
<meta property="article:tag" content="二叉搜索树">
<meta property="article:tag" content="平衡二叉树">
<meta property="article:tag" content="红黑二叉树">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdn.net/20170429162537906?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvanl5MzA1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">


<link rel="canonical" href="http://example.com/2019/08/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95_%E6%A0%91/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<title>二叉搜索树、平衡二叉树、红黑二叉树 | Saltedfish</title><script data-pjax src="/js/load-config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Saltedfish</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to the home of saltedfish</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">156</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">9</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">85</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%91"><span class="nav-number">1.</span> <span class="nav-text">树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91"><span class="nav-number">2.</span> <span class="nav-text">二叉搜索树</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.1.</span> <span class="nav-text">二叉树的介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86"><span class="nav-number">2.2.</span> <span class="nav-text">二叉树的遍历</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%88%E5%BA%8F%E9%81%8D%E5%8E%86-DFS"><span class="nav-number">2.2.1.</span> <span class="nav-text">先序遍历(DFS)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86-DFS%E7%9A%84%E5%8F%98%E7%A7%8D"><span class="nav-number">2.2.2.</span> <span class="nav-text">中序遍历(DFS的变种)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86-DFS%E7%9A%84%E5%8F%98%E7%A7%8D"><span class="nav-number">2.2.3.</span> <span class="nav-text">后序遍历(DFS的变种)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%82%E6%AC%A1%E9%81%8D%E5%8E%86-BFS"><span class="nav-number">2.2.4.</span> <span class="nav-text">层次遍历(BFS)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%EF%BC%88AVL%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">平衡二叉搜索树（AVL）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%A2%E9%BB%91%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91"><span class="nav-number">4.</span> <span class="nav-text">红黑二叉搜索树</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AVL%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">4.1.</span> <span class="nav-text">AVL的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%A2%E9%BB%91%E6%A0%91%E5%AE%9A%E4%B9%89"><span class="nav-number">4.2.</span> <span class="nav-text">红黑树定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%A2%E9%BB%91%E6%A0%91%E7%9A%84%E4%BC%98%E7%82%B9"><span class="nav-number">4.3.</span> <span class="nav-text">红黑树的优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%A2%E9%BB%91%E6%A0%91%E7%9A%84%E7%89%B9%E6%80%A7"><span class="nav-number">4.4.</span> <span class="nav-text">红黑树的特性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Saltedfish"
      src="/uploads/avatar.png">
  <p class="site-author-name" itemprop="name">Saltedfish</p>
  <div class="site-description" itemprop="description">Stay hungry, stay foolish</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">85</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">156</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95_%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.png">
      <meta itemprop="name" content="Saltedfish">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Saltedfish">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          二叉搜索树、平衡二叉树、红黑二叉树
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-12 22:25:15" itemprop="dateCreated datePublished" datetime="2019-08-12T22:25:15+08:00">2019-08-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-01-27 22:13:06" itemprop="dateModified" datetime="2021-01-27T22:13:06+08:00">2021-01-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>29 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="树"><a href="#树" class="headerlink" title="树"></a>树</h2><ul>
<li>树的定义：树是一种数据结构，它是由n(n&gt;=1)个有限结点组成的一个具有层次关系的集合。把它叫做“树”是因为它看起来像一棵倒挂的树，也就是说它是根朝上，而叶朝下的。它具有以下的特点：每个结点有零个或多个子结点；没有父结点的结点称为根结点；每一个非根结点有且只有一个父结点；除了根结点外，每个子结点可以分为多个不相交的子树；</li>
<li>树的大小：节点的数量；</li>
<li>树中一个节点的深度：该节点到根节点的路径上的链接数；</li>
<li>树的高度：所有节点中的最大深度；</li>
<li>根节点的深度：0，所以只含根节点的树的高度为0。<span id="more"></span></li>
</ul>
<h2 id="二叉搜索树"><a href="#二叉搜索树" class="headerlink" title="二叉搜索树"></a>二叉搜索树</h2><blockquote>
<p>二分查找定理：在N个键的有序数组中进行二分查找最多需要(lgN+1)次比较（无论是否成功）。查找失败时，至少需要lgN次，成功最多需要(lgN+1)次。</p>
</blockquote>
<h3 id="二叉树的介绍"><a href="#二叉树的介绍" class="headerlink" title="二叉树的介绍"></a>二叉树的介绍</h3><ul>
<li>二叉搜索树的特点：左子树的节点值比父亲节点小，而右子树的节点值比父节点大。</li>
</ul>
<ul>
<li><p>满二叉树：除最后一层无任何子节点外，每一层上的所有结点都有两个子结点的二叉树。</p>
</li>
<li><p>完全二叉树：n = n<sub>0</sub> + n<sub>1</sub> + n<sub>2</sub>； <strong>n<sub>0</sub> = n<sub>2</sub> + 1</strong>；n<sub>1</sub> = 0 or 1。</p>
</li>
<li><p>完全二叉树的高度：N个节点，高度为<code>$\lfloor lgN \rfloor$</code></p>
</li>
<li><p>二叉树复杂度：所有操作在最坏情况下所需的时间都和树的高度成正比。但在N个点的二叉树中，查找和插入的运行时间增长数量级最坏为N，平均约为1.09lgN。</p>
</li>
</ul>
<h3 id="二叉树的遍历"><a href="#二叉树的遍历" class="headerlink" title="二叉树的遍历"></a>二叉树的遍历</h3><blockquote>
<p>相关题目： acwing 19 18 1259</p>
</blockquote>
<h4 id="先序遍历-DFS"><a href="#先序遍历-DFS" class="headerlink" title="先序遍历(DFS)"></a>先序遍历(DFS)</h4><p>遍历顺序规则为: 根左右；两种实现：递归 or 栈</p>
<h4 id="中序遍历-DFS的变种"><a href="#中序遍历-DFS的变种" class="headerlink" title="中序遍历(DFS的变种)"></a>中序遍历(DFS的变种)</h4><p>遍历顺序规则为: 左根右</p>
<h4 id="后序遍历-DFS的变种"><a href="#后序遍历-DFS的变种" class="headerlink" title="后序遍历(DFS的变种)"></a>后序遍历(DFS的变种)</h4><p>遍历顺序规则为: 左右根</p>
<h4 id="层次遍历-BFS"><a href="#层次遍历-BFS" class="headerlink" title="层次遍历(BFS)"></a>层次遍历(BFS)</h4><p>遍历顺序规则为: 从左到右按层；借助队列实现</p>
<blockquote>
<p>给定一种遍历的顺序不能确定一个唯一的二叉树（除非告诉我们空节点在完全二叉树的位置），但如果告诉我们中序遍历顺序和其他任意一种遍历顺序，就能够唯一确定一颗二叉树。</p>
</blockquote>
<p><code>Show me the code</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinarySearchTree</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">BSTNode</span>&lt;<span class="title">U</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> U value;</span><br><span class="line">        <span class="keyword">private</span> BSTNode&lt;U&gt; parent;</span><br><span class="line">        <span class="keyword">private</span> BSTNode&lt;U&gt; left;</span><br><span class="line">        <span class="keyword">private</span> BSTNode&lt;U&gt; right;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">BSTNode</span><span class="params">(U value, BSTNode&lt;U&gt; parent, BSTNode&lt;U&gt; left, BSTNode&lt;U&gt; right)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="keyword">this</span>.parent = parent;</span><br><span class="line">            <span class="keyword">this</span>.left = left;</span><br><span class="line">            <span class="keyword">this</span>.right = right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> BSTNode)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">            BSTNode&lt;?&gt; bstNode = (BSTNode&lt;?&gt;) o;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!value.equals(bstNode.value)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (parent != <span class="keyword">null</span> ? !parent.equals(bstNode.parent) : bstNode.parent != <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (left != <span class="keyword">null</span> ? !left.equals(bstNode.left) : bstNode.left != <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (right != <span class="keyword">null</span> ? !right.equals(bstNode.right) : bstNode.right != <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> value.hashCode();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BSTNode&lt;T&gt; root;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> Comparator&lt;T&gt; cmp ;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BinarySearchTree</span><span class="params">(Comparator cmp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cmp = cmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查找</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BSTNode&lt;T&gt; <span class="title">get</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> get(value,root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> BSTNode&lt;T&gt; <span class="title">get</span><span class="params">(T value, BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> compare = cmp.compare(value, root.value);</span><br><span class="line">        <span class="keyword">if</span> (compare == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (compare &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> get(value, root.left);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> get(value, root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(T value, BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        BSTNode&lt;T&gt; temp = root;</span><br><span class="line">        BSTNode&lt;T&gt; tempParent = temp;</span><br><span class="line">        <span class="keyword">while</span> (temp != <span class="keyword">null</span>) &#123;</span><br><span class="line">            tempParent = temp;</span><br><span class="line">            <span class="keyword">int</span> compare = cmp.compare(value, temp.value);</span><br><span class="line">            <span class="keyword">if</span> (compare &lt; <span class="number">0</span>)</span><br><span class="line">                temp = temp.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (compare &gt; <span class="number">0</span>)</span><br><span class="line">                temp = temp.right;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Nodes already exist, duplicate insertion is prohibited, doing nothing!&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">assert</span> tempParent != <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (cmp.compare(value,tempParent.value) &lt; <span class="number">0</span>)</span><br><span class="line">            tempParent.left = <span class="keyword">new</span> BSTNode&lt;&gt;(value,tempParent,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            tempParent.right = <span class="keyword">new</span> BSTNode&lt;&gt;(value,tempParent,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 插入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">            root = <span class="keyword">new</span> BSTNode&lt;T&gt;(value,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">            size++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            put(value, root);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">transplant</span><span class="params">(BSTNode&lt;T&gt; nodeToBeDelete, BSTNode&lt;T&gt; childNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nodeToBeDelete.parent.left == nodeToBeDelete)</span><br><span class="line">            nodeToBeDelete.parent.left = childNode;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            nodeToBeDelete.parent.right = childNode;</span><br><span class="line">        <span class="keyword">if</span> (childNode != <span class="keyword">null</span>)</span><br><span class="line">            childNode.parent = nodeToBeDelete.parent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    删除一个节点:</span></span><br><span class="line"><span class="comment">        1. 被删除节点没有子树的情况，直接删除，并修改对应父节点的指针为空。</span></span><br><span class="line"><span class="comment">        2. 对于只有一个子树的情况，考虑将其子树作为其父节点的子树，根据被删除的节点确定：</span></span><br><span class="line"><span class="comment">                        如果被删除的节点是其父节点的左子树，则其子树作为左子树连到其父节点；</span></span><br><span class="line"><span class="comment">                        如果被删除的节点是其父节点的右子树，则其子树作为右子树连到其父节点。</span></span><br><span class="line"><span class="comment">        3. 有两个子树的情况，可以考虑两种方法：</span></span><br><span class="line"><span class="comment">                        用被删除节点A的右子树的最左节点或者A的左子树的最右节点作为替代A的节点，并修改相应的最左或最右节点的父节点的指针。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        BSTNode&lt;T&gt; nodeToBeDeleted = get(value);</span><br><span class="line">        <span class="keyword">if</span> (nodeToBeDeleted == <span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;The point to be deleted does not exist!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nodeToBeDeleted.left == <span class="keyword">null</span> &amp;&amp; nodeToBeDeleted.right == <span class="keyword">null</span>) <span class="comment">// 叶子节点</span></span><br><span class="line">            transplant(nodeToBeDeleted,<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nodeToBeDeleted.left == <span class="keyword">null</span>)                             <span class="comment">// 左子树为空</span></span><br><span class="line">            transplant(nodeToBeDeleted, nodeToBeDeleted.right);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nodeToBeDeleted.right == <span class="keyword">null</span>)                            <span class="comment">// 右子树为空</span></span><br><span class="line">            transplant(nodeToBeDeleted, nodeToBeDeleted.left);</span><br><span class="line">        <span class="keyword">else</span> &#123;                                                             <span class="comment">// 左右子树都不为空：右子树最左点替换</span></span><br><span class="line">            BSTNode&lt;T&gt; minModeOfRight = getMinNode(nodeToBeDeleted.right);</span><br><span class="line">            <span class="keyword">if</span> (minModeOfRight == nodeToBeDeleted.right) &#123;  <span class="comment">// 是删除节点的直接右孩子</span></span><br><span class="line">                transplant(nodeToBeDeleted,minModeOfRight);</span><br><span class="line">                minModeOfRight.left = nodeToBeDeleted.left;</span><br><span class="line">                nodeToBeDeleted.left.parent = minModeOfRight;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;                                        <span class="comment">// 不是删除节点的直接右孩子</span></span><br><span class="line">                transplant(minModeOfRight,minModeOfRight.right);</span><br><span class="line">                transplant(nodeToBeDeleted,minModeOfRight);</span><br><span class="line">                minModeOfRight.left = nodeToBeDeleted.left;</span><br><span class="line">                nodeToBeDeleted.left.parent = minModeOfRight;</span><br><span class="line">                minModeOfRight.right = nodeToBeDeleted.right;</span><br><span class="line">                nodeToBeDeleted.right.parent = minModeOfRight;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        size--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> BSTNode&lt;T&gt; <span class="title">getMaxNode</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        BSTNode&lt;T&gt; max = root;</span><br><span class="line">        <span class="keyword">while</span> (max.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">            max = max.right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getMaxNode(root).value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> BSTNode&lt;T&gt; <span class="title">getMinNode</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        BSTNode&lt;T&gt; min = root;</span><br><span class="line">        <span class="keyword">while</span> (min.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">            min = min.left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getMinNode(root).value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先序遍历(DFS) -- 递归实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrderTraversal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        preOrderTraversal(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">preOrderTraversal</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        System.out.print(root.value + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        preOrderTraversal(root.left);</span><br><span class="line">        preOrderTraversal(root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 中序遍历</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inOrderTraversal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        inOrderTraversal(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">inOrderTraversal</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        inOrderTraversal(root.left);</span><br><span class="line">        System.out.print(root.value + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        inOrderTraversal(root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 后序遍历</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postOrderTraversal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        postOrderTraversal(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">postOrderTraversal</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        postOrderTraversal(root.left);</span><br><span class="line">        postOrderTraversal(root.right);</span><br><span class="line">        System.out.print(root.value + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先序遍历(DFS) -- 栈实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrderTraversalStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        preOrderTraversalStack(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">preOrderTraversalStack</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        LinkedList&lt;BSTNode&lt;T&gt;&gt; stack = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        BSTNode&lt;T&gt; top = root;</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty() || top != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (top != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.print(top.value + <span class="string">&quot; &quot;</span>); <span class="comment">// 每次入栈输出</span></span><br><span class="line">                stack.push(top);</span><br><span class="line">                top = top.left; <span class="comment">// 继续往左子树深入</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// top == null</span></span><br><span class="line">                top = stack.pop().right; <span class="comment">// 出栈往右子树深入</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 层次遍历</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">levelOrderTraversal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        levelOrderTraversal(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 层次遍历(BFS) -- 队列</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">levelOrderTraversal</span><span class="params">(BSTNode&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        LinkedList&lt;BSTNode&lt;T&gt;&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        queue.add(root);</span><br><span class="line">        BSTNode&lt;T&gt; head;</span><br><span class="line">        <span class="keyword">while</span> (!queue.isEmpty())&#123;</span><br><span class="line">            head = queue.remove();</span><br><span class="line">            System.out.print(head.value + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (head.left != <span class="keyword">null</span>)</span><br><span class="line">                queue.add(head.left);</span><br><span class="line">            <span class="keyword">if</span> (head.right != <span class="keyword">null</span>)</span><br><span class="line">                queue.add(head.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestBST</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BinarySearchTree&lt;Integer&gt; bst = <span class="keyword">new</span> BinarySearchTree&lt;&gt;((Comparator&lt;Integer&gt;) (o1, o2) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span>(o1 &lt; o2)</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (o1 &gt; o2)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] arrayInt = &#123;<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : arrayInt) &#123;</span><br><span class="line">            bst.put(i);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        bst.delete(1);</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;size: &quot;</span> + bst.getSize() + <span class="string">&quot;    Max: &quot;</span> + bst.getMax() + <span class="string">&quot;  Min: &quot;</span> + bst.getMin());</span><br><span class="line">        System.out.print(<span class="string">&quot;PreOrder:   &quot;</span>);        bst.preOrderTraversal();        <span class="comment">// 5 1 0 4 2 3 9 7 6 8</span></span><br><span class="line">        System.out.print(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;PreOrder:   &quot;</span>); bst.preOrderTraversalStack();   <span class="comment">// 5 1 0 4 2 3 9 7 6 8</span></span><br><span class="line">        System.out.print(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;InOrder:    &quot;</span>); bst.inOrderTraversal();         <span class="comment">// 0 1 2 3 4 5 6 7 8 9</span></span><br><span class="line">        System.out.print(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;PostOrder:  &quot;</span>); bst.postOrderTraversal();       <span class="comment">// 0 3 2 4 1 6 8 7 9 5</span></span><br><span class="line">        System.out.print(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;LevelOrder: &quot;</span>); bst.levelOrderTraversal();      <span class="comment">// 5 1 9 0 4 7 2 6 8 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="平衡二叉搜索树（AVL）"><a href="#平衡二叉搜索树（AVL）" class="headerlink" title="平衡二叉搜索树（AVL）"></a>平衡二叉搜索树（AVL）</h2><ul>
<li>AVL树的引入：平衡二叉树在二叉排序树上引入的，在二叉树中，如果插入的节点接近有序，那么二叉树就会退化为链表大大降低了查找效率，为了使二叉树无论什么情况下最大限度的接近满二叉树，从而保证它的查找效率，因此引入平衡二叉树。</li>
</ul>
<ul>
<li><p>AVL定义：满足二叉搜索树的特性基础上，它的左子树和右子树的高度之差的绝对值不超过1，并且左子树和右子树也是一个平衡二叉树。</p>
</li>
<li><p>平衡因子：左子树高度减去右子树的高度的值或者右子树高度减去左子树高度的值。显然 -1 &lt;=bf &lt;= 1，下面分析假设右减左。</p>
</li>
<li><p>AVL树的实现：如何保证二叉树在任何情况下都能最大限度接近满二叉树，从而保证它的查找效率呢？那就是旋转，当平衡因子的绝对值大于1的时候，我们就需要对其进行旋转。</p>
<blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jyy305/article/details/70949010">https://blog.csdn.net/jyy305/article/details/70949010</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/dYP5-fM22BgM3viWg4V44A">https://mp.weixin.qq.com/s/dYP5-fM22BgM3viWg4V44A</a></p>
</blockquote>
</li>
</ul>
<p>在插入的过程中，会出现以下四种情况破坏AVL树的特性，我们可以采取如下相应的旋转。</p>
<ol>
<li>左-左型：做右旋；</li>
<li>右-右型：做左旋；</li>
<li>左-右型：先做左旋转成左-左型，再做右旋；</li>
<li>右-左型：先做右旋转成右-右型，再做左旋。</li>
</ol>
<img src="https://img-blog.csdn.net/20170429162537906?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvanl5MzA1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="img" style="zoom:80%;" />

<p><code>Show me the code</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义节点</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AvlNode</span> </span>&#123;</span><br><span class="line">   <span class="keyword">int</span> data;</span><br><span class="line">   AvlNode lchild;<span class="comment">//左孩子</span></span><br><span class="line">   AvlNode rchild;<span class="comment">//右孩子</span></span><br><span class="line">   <span class="keyword">int</span> height;<span class="comment">//记录节点的高度</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在这里定义各种操作</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AVLTree</span></span>&#123;</span><br><span class="line">   <span class="comment">//计算节点的高度</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">height</span><span class="params">(AvlNode T)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (T == <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">return</span> T.height;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//左左型，右旋操作，k2代表bf为-2的根节点，即最大不平衡树的根节点（下同）</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> AvlNode <span class="title">R_Rotate</span><span class="params">(AvlNode K2)</span> </span>&#123;</span><br><span class="line">       AvlNode K1;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//进行旋转</span></span><br><span class="line">       K1 = K2.lchild;</span><br><span class="line">       K2.lchild = K1.rchild;</span><br><span class="line">       K1.rchild = K2;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//重新计算节点的高度</span></span><br><span class="line">       K2.height = Math.max(height(K2.lchild), height(K2.rchild)) + <span class="number">1</span>;</span><br><span class="line">       K1.height = Math.max(height(K1.lchild), height(K1.rchild)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> K1;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//右右型，左旋操作k2代表bf为2的根节点，即最大不平衡树的根节点</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> AvlNode <span class="title">L_Rotate</span><span class="params">(AvlNode K2)</span> </span>&#123;</span><br><span class="line">       AvlNode K1;</span><br><span class="line"></span><br><span class="line">       K1 = K2.rchild;</span><br><span class="line">       K2.rchild = K1.lchild;</span><br><span class="line">       K1.lchild = K2;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//重新计算高度</span></span><br><span class="line">       K2.height = Math.max(height(K2.lchild), height(K2.rchild)) + <span class="number">1</span>;</span><br><span class="line">       K1.height = Math.max(height(K1.lchild), height(K1.rchild)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> K1;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//左-右型，进行左旋，再右旋，k3代表bf为-2的根节点，即最大不平衡树的根节点</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> AvlNode <span class="title">L_R_Rotate</span><span class="params">(AvlNode K3)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//先对其孩子进行左旋</span></span><br><span class="line">       K3.lchild =L_Rotate(K3.lchild);</span><br><span class="line">       <span class="comment">//再进行右旋</span></span><br><span class="line">       <span class="keyword">return</span> R_Rotate(K3);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//右-左型，先进行右旋，再左旋，k3代表bf为2的根节点，即最大不平衡树的根节点</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> AvlNode <span class="title">R_L_Rotate</span><span class="params">(AvlNode K3)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//先对孩子进行右旋</span></span><br><span class="line">       K3.rchild = R_Rotate(K3.rchild);</span><br><span class="line">       <span class="comment">//再进行左旋</span></span><br><span class="line">       <span class="keyword">return</span> L_Rotate(K3);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//插入数值操作</span></span><br><span class="line">   <span class="function"><span class="keyword">static</span> AvlNode <span class="title">insert</span><span class="params">(<span class="keyword">int</span> data, AvlNode T)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (T == <span class="keyword">null</span>) &#123;</span><br><span class="line">           T = <span class="keyword">new</span> AvlNode();</span><br><span class="line">           T.data = data;</span><br><span class="line">           T.lchild = T.rchild = <span class="keyword">null</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span>(data &lt; T.data) &#123;</span><br><span class="line">           <span class="comment">//向左孩子递归插入</span></span><br><span class="line">           T.lchild = insert(data, T.lchild);</span><br><span class="line">           <span class="comment">//进行调整操作</span></span><br><span class="line">           <span class="comment">//如果左孩子的高度比右孩子大2</span></span><br><span class="line">           <span class="keyword">if</span> (height(T.lchild) - height(T.rchild) == <span class="number">2</span>) &#123;</span><br><span class="line">               <span class="comment">//左-左型</span></span><br><span class="line">               <span class="keyword">if</span> (data &lt; T.lchild.data) &#123;</span><br><span class="line">                   T = R_Rotate(T);</span><br><span class="line">               &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   <span class="comment">//左-右型</span></span><br><span class="line">                   T = R_L_Rotate(T);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data &gt; T.data) &#123;</span><br><span class="line">           T.rchild = insert(data, T.rchild);</span><br><span class="line">           <span class="comment">//进行调整</span></span><br><span class="line">           <span class="comment">//右孩子比左孩子高度大2</span></span><br><span class="line">           <span class="keyword">if</span>(height(T.rchild) - height(T.lchild) == <span class="number">2</span>)</span><br><span class="line">               <span class="comment">//右-右型</span></span><br><span class="line">               <span class="keyword">if</span> (data &gt; T.rchild.data) &#123;</span><br><span class="line">                   T = L_Rotate(T);</span><br><span class="line">               &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   T = L_R_Rotate(T);</span><br><span class="line">               &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//否则，这个节点已经在树上存在了，我们什么也不做</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">//重新计算T的高度</span></span><br><span class="line">       T.height = Math.max(height(T.lchild), height(T.rchild)) + <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">return</span> T;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="红黑二叉搜索树"><a href="#红黑二叉搜索树" class="headerlink" title="红黑二叉搜索树"></a>红黑二叉搜索树</h2><h3 id="AVL的问题"><a href="#AVL的问题" class="headerlink" title="AVL的问题"></a>AVL的问题</h3><p>虽然平衡树解决了二叉查找树退化为近似链表的缺点，能够把查找时间控制在 O(logn)，不过却不是最佳的，因为平衡树要求<strong>每个节点的左子树和右子树的高度差至多等于1</strong>，这个要求实在是太严了，导致每次进行插入、删除节点的时候，几乎都会破坏平衡树的第二个规则，进而都需要通过不断的左旋和右旋来进行调整。<strong>尤其是在动态插入的场景中，平衡树需要频繁着进行调整</strong>，这会使它的性能大打折扣，为了解决这个问题，于是有了<strong>红黑树</strong>。</p>
<h3 id="红黑树定义"><a href="#红黑树定义" class="headerlink" title="红黑树定义"></a>红黑树定义</h3><p>红黑树的一种定义方式是含有<strong>红黑链接</strong>并满足下列条件的<strong>二叉搜索树</strong>：</p>
<ol>
<li>红链接均为左链接；</li>
<li>没有任何一个节点同时与两条红链接相连；</li>
<li>该树完美黑色平衡，即任意空链接到根节点的路径上的黑链接数量相同。</li>
</ol>
<blockquote>
<p>每个节点内维护着一个颜色变量，这里红色节点指其父节点指向它的链接的颜色为红色，即红链接指向它；黑色节点指其父节点指向它的链接的颜色是黑色，即黑链接指向它。</p>
</blockquote>
<h3 id="红黑树的优点"><a href="#红黑树的优点" class="headerlink" title="红黑树的优点"></a>红黑树的优点</h3><p>红黑树在插入、删除等操作，不会像AVL那样频繁着破坏红黑树的规则，所以不需要频繁调整，在插入、删除方面红黑树性能远远优于AVL，这也是我们为什么大多数情况下使用红黑树的原因。单单在查找方面的效率的话，AVL的确比红黑树快。所以，我们也可以说，<strong>红黑树是一种不大严格的平衡树</strong>，也可以说是一个折中的方案。</p>
<h3 id="红黑树的特性"><a href="#红黑树的特性" class="headerlink" title="红黑树的特性"></a>红黑树的特性</h3><ul>
<li>一颗大小为N的红黑树的高度不会超过2lgN：因为黑链接完美平衡，红链接和黑链接交叉链接，所以高度不会超过2lgN。</li>
<li>查找和插入的最坏情况下的运行时间增长数量级为2lgN，平均约为1.001lgN。</li>
</ul>
<p><code>Show me the code</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedBlackBST</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> RED = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> BLACK = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">U</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> U value;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;U&gt; parent;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;U&gt; left;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;U&gt; right;</span><br><span class="line">        <span class="comment">// 由其父节点指向它的链接的颜色, 也说红色/黑色节点，这里红色/黑色节点指其父节点指向它的链接的颜色为红色/黑色</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> color; <span class="comment">// true:RED false：BLACK</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(U value, Node&lt;U&gt; parent, Node&lt;U&gt; left, Node&lt;U&gt; right, <span class="keyword">boolean</span> color)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="keyword">this</span>.parent = parent;</span><br><span class="line">            <span class="keyword">this</span>.left = left;</span><br><span class="line">            <span class="keyword">this</span>.right = right;</span><br><span class="line">            <span class="keyword">this</span>.color = color;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; root;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RedBlackBST</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getRoot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> root.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isRed</span><span class="params">(Node&lt;T&gt; node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> node.color == RED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRed</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        Node&lt;T&gt; node = get(value,root);</span><br><span class="line">        <span class="keyword">return</span> isRed(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">get</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> get(value,root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node&lt;T&gt; <span class="title">get</span><span class="params">(T value, Node&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;The point you are looking for does not exist!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (value.compareTo(root.value) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> get(value, root.left);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (value.compareTo(root.value) &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> get(value,root.right);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 左旋：当红链接向右指时（即小指大），左旋变成向左指（即大指小）；当出现连续的红链接时，下层左旋</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node&lt;T&gt; <span class="title">rotateLeft</span><span class="params">(Node&lt;T&gt; p)</span> </span>&#123;</span><br><span class="line">        Node&lt;T&gt; x = p.right;</span><br><span class="line">        p.right = x.left;</span><br><span class="line">        x.left = p;</span><br><span class="line">        x.color = p.color;</span><br><span class="line">        p.color = RED;</span><br><span class="line">        x.parent = p.parent;</span><br><span class="line">        p.parent = x;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 右旋：当红链接向左指时（即大指小），右旋变成向右指（即小指大）；当出现连续的红链接时，上层右旋</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node&lt;T&gt; <span class="title">rotateRight</span><span class="params">(Node&lt;T&gt; p)</span> </span>&#123;</span><br><span class="line">        Node&lt;T&gt; x = p.left;</span><br><span class="line">        p.left = x.right;</span><br><span class="line">        x.right = p;</span><br><span class="line">        x.color = p.color;</span><br><span class="line">        p.color = RED;</span><br><span class="line">        x.parent = p.parent;</span><br><span class="line">        p.parent = x;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 颜色变换：即将两个子节点链接颜色-&gt;BLACK，父节点链接颜色-&gt;RED</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">filpColors</span><span class="params">(Node&lt;T&gt; p)</span> </span>&#123;</span><br><span class="line">        p.color = RED;</span><br><span class="line">        p.left.color = BLACK;</span><br><span class="line">        p.right.color = BLACK;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 插入：红黑二叉树规定插入的链接为红链接，然后分情况进行旋转调整，大体可分为以下几种情况</span></span><br><span class="line"><span class="comment">            case1: 向树底部的2-节点插入</span></span><br><span class="line"><span class="comment">                case1_1: 左插入，父节点直接成为3-节点，无需调整；</span></span><br><span class="line"><span class="comment">                case1_2: 右插入，父节点成为一个错误的3-节点，存在向右的红链接，需左旋父节点；</span></span><br><span class="line"><span class="comment">            case2: 向树底部的3-节点插入</span></span><br><span class="line"><span class="comment">                case2_1: 右插入，得到一个2-3平衡树，只需要进行颜色变换，即将两个子节点链接颜色-&gt;BLACK，父节点链接颜色-&gt;RED；</span></span><br><span class="line"><span class="comment">                case2_2: 左插入，形成两条连续同向的红链接，右旋上层的红链接（父节点）到case2_1，执行case2_1后续操作；</span></span><br><span class="line"><span class="comment">                case2_3: 中插入，形成两条连续不同向的红链接，左旋下层的红链接（父节点的左子节点）到case2_2，执行case2_2后续操作。</span></span><br><span class="line"><span class="comment">       当然上面 5 种情况可以归纳成 4 种情况，其中case1_1无需调整，不考虑，那么就是 3 种需要调整的情况：</span></span><br><span class="line"><span class="comment">            case1: 如果父节点p的右子节点是红色并且左子节点是黑色，进行左旋（p）；</span></span><br><span class="line"><span class="comment">            case2: 如果父节点p的左子节点是红色并且左子节点的左子节点也是红色，进行右旋（p）；</span></span><br><span class="line"><span class="comment">            case3: 如果父节点p的左子节点是红色并且右子节点也是红色，进行颜色变换；</span></span><br><span class="line"><span class="comment">            end: 最后要设置根节点为黑色节点，每次根节点由红变黑则树的黑链接高度+1。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 插入，不允许重复，如果已存在会return，每次插入都可能会更新根节点</span></span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">            root =  <span class="keyword">new</span> Node&lt;T&gt;(value, <span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>, BLACK);</span><br><span class="line">            size++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            root = put(root, value, root);</span><br><span class="line">            size++;</span><br><span class="line">            root.color = BLACK;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Node&lt;T&gt; <span class="title">put</span><span class="params">(Node&lt;T&gt; p, T value, Node&lt;T&gt; parent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Node&lt;T&gt;(value,parent,<span class="keyword">null</span>,<span class="keyword">null</span>, RED);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> compare = value.compareTo(p.value);</span><br><span class="line">        <span class="keyword">if</span> (compare &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            p.left = put(p.left,value,p);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (compare &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            p.right = put(p.right,value,p);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Nodes already exist, duplicate insertion is prohibited, doing nothing!&quot;</span>);</span><br><span class="line">            size--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isRed(p.right) &amp;&amp; !isRed(p.left))</span><br><span class="line">            p = rotateLeft(p);</span><br><span class="line">        <span class="keyword">if</span> (isRed(p.left) &amp;&amp; isRed(p.left.left))</span><br><span class="line">            p = rotateRight(p);</span><br><span class="line">        <span class="keyword">if</span> (isRed(p.left) &amp;&amp; isRed(p.right))</span><br><span class="line">            filpColors(p);</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先序遍历(DFS) -- 递归实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrderTraversal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        preOrderTraversal(root);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">preOrderTraversal</span><span class="params">(Node&lt;T&gt; root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        System.out.print(root.value + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        preOrderTraversal(root.left);</span><br><span class="line">        preOrderTraversal(root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestRedBlackBST</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RedBlackBST&lt;Integer&gt; redBlackBST = <span class="keyword">new</span> RedBlackBST&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span>[] arrayInt = &#123;<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : arrayInt) &#123;</span><br><span class="line">            redBlackBST.put(i);</span><br><span class="line"><span class="comment">//            System.out.println(redBlackBST.getRoot());</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Size: &quot;</span> + redBlackBST.getSize());</span><br><span class="line">        System.out.print(<span class="string">&quot;PreOrder: &quot;</span>); redBlackBST.preOrderTraversal(); <span class="comment">// 8 5 1 7 9</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><table>
<thead>
<tr>
<th align="center">时间复杂度</th>
<th align="center">最坏情况</th>
<th align="center">平均情况</th>
<th align="center">最坏情况</th>
<th align="center">平均情况</th>
</tr>
</thead>
<tbody><tr>
<td align="center">操作</td>
<td align="center">查找</td>
<td align="center">查找</td>
<td align="center">插入</td>
<td align="center">插入</td>
</tr>
<tr>
<td align="center">顺序查询（无序链表）</td>
<td align="center">N</td>
<td align="center">N/2</td>
<td align="center">N</td>
<td align="center">N</td>
</tr>
<tr>
<td align="center">二分查找（有序数组）</td>
<td align="center">lgN</td>
<td align="center">lgN</td>
<td align="center">N</td>
<td align="center">N/2</td>
</tr>
<tr>
<td align="center">二叉树查找（BST）</td>
<td align="center">N</td>
<td align="center">1.39lgN</td>
<td align="center">N</td>
<td align="center">1.39lgN</td>
</tr>
<tr>
<td align="center">2-3树查找（红黑树）</td>
<td align="center">2lgN</td>
<td align="center">1.001lgN</td>
<td align="center">2lgN</td>
<td align="center">1.001lgN</td>
</tr>
</tbody></table>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" rel="tag"><i class="fa fa-tag"></i> 二叉搜索树</a>
              <a href="/tags/%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91/" rel="tag"><i class="fa fa-tag"></i> 平衡二叉树</a>
              <a href="/tags/%E7%BA%A2%E9%BB%91%E4%BA%8C%E5%8F%89%E6%A0%91/" rel="tag"><i class="fa fa-tag"></i> 红黑二叉树</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/07/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95_%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84%E6%80%BB%E7%BB%93/" rel="prev" title="各种排序算法的总结">
                  <i class="fa fa-chevron-left"></i> 各种排序算法的总结
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/08/25/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95_%E5%8A%A0%E6%9D%83%E6%97%A0%E5%90%91%E5%9B%BE/" rel="next" title="加权无向图的遍历（DFS、BFS）和最小生成树(Prim、Kruskal)">
                  加权无向图的遍历（DFS、BFS）和最小生成树(Prim、Kruskal) <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>





<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Saltedfish</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">555k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16:48</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>

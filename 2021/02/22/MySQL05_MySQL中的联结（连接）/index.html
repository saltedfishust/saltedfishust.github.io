<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;example.com&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="按照我的理解，我将数据库中的连接（同联结）分类如下图，稍后我将解释我为什么这么分。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL中的联结（连接）">
<meta property="og:url" content="http://example.com/2021/02/22/MySQL05_MySQL%E4%B8%AD%E7%9A%84%E8%81%94%E7%BB%93%EF%BC%88%E8%BF%9E%E6%8E%A5%EF%BC%89/index.html">
<meta property="og:site_name" content="Saltedfish">
<meta property="og:description" content="按照我的理解，我将数据库中的连接（同联结）分类如下图，稍后我将解释我为什么这么分。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/85A7D2ECD48A47469FD635918916A023?method=download&shareKey=0dcc57c6c1e4551d40057b6d7023dec0">
<meta property="article:published_time" content="2021-02-21T17:12:45.000Z">
<meta property="article:modified_time" content="2021-07-25T06:37:59.618Z">
<meta property="article:author" content="Saltedfish">
<meta property="article:tag" content="笛卡尔积">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note.youdao.com/yws/api/personal/file/85A7D2ECD48A47469FD635918916A023?method=download&shareKey=0dcc57c6c1e4551d40057b6d7023dec0">


<link rel="canonical" href="http://example.com/2021/02/22/MySQL05_MySQL%E4%B8%AD%E7%9A%84%E8%81%94%E7%BB%93%EF%BC%88%E8%BF%9E%E6%8E%A5%EF%BC%89/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<title>MySQL中的联结（连接） | Saltedfish</title><script data-pjax src="/js/load-config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Saltedfish</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to the home of saltedfish</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">156</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">9</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">85</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.</span> <span class="nav-text">数据库中的连接</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%BF%E4%B9%89%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="nav-number">1.1.</span> <span class="nav-text">广义内连接（交叉连接）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="nav-number">1.1.1.</span> <span class="nav-text">内连接（等值连接）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.1.2.</span> <span class="nav-text">自然连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.1.3.</span> <span class="nav-text">自连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.</span> <span class="nav-text">外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.1.</span> <span class="nav-text">左外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.2.</span> <span class="nav-text">右外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.3.</span> <span class="nav-text">全外连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%94%E7%BB%93%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.</span> <span class="nav-text">联结算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Simple-Nested-Loops-Join%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.1.</span> <span class="nav-text">Simple Nested-Loops Join算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Block-Nested-Loops-Join%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.2.</span> <span class="nav-text">Block Nested-Loops Join算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Classic-Hash-Join%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.3.</span> <span class="nav-text">Classic Hash Join算法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="nav-number">1.4.</span> <span class="nav-text">集合操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UNION-DISTINCT"><span class="nav-number">1.4.1.</span> <span class="nav-text">UNION [DISTINCT]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UNION-ALL"><span class="nav-number">1.4.2.</span> <span class="nav-text">UNION ALL</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Saltedfish"
      src="/uploads/avatar.png">
  <p class="site-author-name" itemprop="name">Saltedfish</p>
  <div class="site-description" itemprop="description">Stay hungry, stay foolish</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">85</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">156</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/22/MySQL05_MySQL%E4%B8%AD%E7%9A%84%E8%81%94%E7%BB%93%EF%BC%88%E8%BF%9E%E6%8E%A5%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.png">
      <meta itemprop="name" content="Saltedfish">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Saltedfish">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL中的联结（连接）
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-02-22 01:12:45" itemprop="dateCreated datePublished" datetime="2021-02-22T01:12:45+08:00">2021-02-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-25 14:37:59" itemprop="dateModified" datetime="2021-07-25T14:37:59+08:00">2021-07-25</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>14 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>按照我的理解，我将数据库中的连接（同联结）分类如下图，稍后我将解释我为什么这么分。</p>
<p><img src="https://note.youdao.com/yws/api/personal/file/85A7D2ECD48A47469FD635918916A023?method=download&shareKey=0dcc57c6c1e4551d40057b6d7023dec0"></p>
<span id="more"></span>

<h1 id="数据库中的连接"><a href="#数据库中的连接" class="headerlink" title="数据库中的连接"></a>数据库中的连接</h1><h2 id="广义内连接（交叉连接）"><a href="#广义内连接（交叉连接）" class="headerlink" title="广义内连接（交叉连接）"></a>广义内连接（交叉连接）</h2><p>所有的广义内连接的核心和共同点是完全基于<strong>笛卡尔积</strong>原理的，两个表进行笛卡尔积运算得到的结果表是由第一个表的每一行与第二个表的每一行拼接后形成的表，称为‘笛卡尔积表’，结果表的行数等于两个表的行数之积，接下来介绍的所有广义内连接的结果都能在笛卡尔积表里找到。两个表直接做笛卡尔积运算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * from 表1 [CROSS] JOIN 表2；</span><br></pre></td></tr></table></figure>
<p>注意，这里没有任何限制和条件，这种联结称为<strong>交叉连接</strong>，得到的结果就是两个表的笛卡尔积，这是所有广义内连接的基础，所有广义内连接在原理上都是通过在笛卡尔积的基础上进行过滤得到的。</p>
<h3 id="内连接（等值连接）"><a href="#内连接（等值连接）" class="headerlink" title="内连接（等值连接）"></a>内连接（等值连接）</h3><p>现在我们要在笛卡尔积的基础上进行过滤了，以选择我们需要的记录（行）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 写法1：显式内连接，通过ON进行过滤</span><br><span class="line">SELECT * from 表1 [INNER] JOIN 表2 ON 等值条件；</span><br><span class="line">-- 写法2：隐式内连接，通过WHERE进行过滤</span><br><span class="line">SELECT * from 表1，表2 WHERE 等值条件；</span><br></pre></td></tr></table></figure>
<p>注意这里的条件是等值条件，一般类似 <strong>表1.字段1=表2.字段2</strong> 这种（字段就是列），所以内连接又称为等值连接。内连接允许条件不是等值的，那就不是等值连接就是一般的内连接了。不过我们一般都用等值连接。内连接也允许没有等值条件，如果没有 ON 的话此时就等同于交叉联结CROSS JOIN。</p>
<h3 id="自然连接"><a href="#自然连接" class="headerlink" title="自然连接"></a>自然连接</h3><p>上面提到内连接是对行进行过滤，那可不可以对列进行过滤哪？当然可以。一般的情况就是当我们对两个表进行交叉连接后，会有重复的列，即此列在两个表里同时存在，<strong>自然连接会排除多次出现的列，使每一列只返回一次</strong>。怎样完成这项工作呢？答案是，系统不完成这项工作，由你自己完成它。自然连接要求你只能选择那些唯一的列，一般通过对一个表使用通配符（SELECT *），而对其他表的列使用明确的子集来完成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 写法1</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1 [INNER] JOIN 表2；</span><br><span class="line">-- 写法2</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1，表2；</span><br></pre></td></tr></table></figure>
<p>但一般我们是既对行进行过滤也对列进行过滤，事实上，我们几乎使用的每个内连接都是自然连接，很可能永远都不会用到不是自然连接的内连接，即它们两个是搭配使用的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 写法1</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1 [INNER] JOIN 表2 ON 等值条件；</span><br><span class="line">-- 写法2</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1，表2 WHERE 等值条件；</span><br></pre></td></tr></table></figure>

<p>在MySQL中有提供实现的自然连接（NATURAL JOIN），注意这里的自然连接跟我们上面说的有那么一点点不同，NATURAL JOIN等同于INNTER JOIN与USING的组合，它隐含的作用是将两个表中具有相同名称的列进行匹配，前提是两个表必须含有相同名字的列，然后我们可以省略ON条件，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> 表<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">等同于</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> 表<span class="number">1</span> [<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> <span class="keyword">ON</span> t1.same_column <span class="operator">=</span> t2.same_column;</span><br></pre></td></tr></table></figure>


<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><p>自连接顾名思义就是自己跟自己连接，说白了他本质上还是一种特殊的自己跟自己的交叉连接，自连接的实现必须借助给表起别名，如果不用别名就会报错，因为要多次调用同一个表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 写法1，AS t1为起别名操作，注意也可以省略AS，直接t1即可</span><br><span class="line">SELECT * from 表1 [AS] t1 [INNER] JOIN 表2 [AS] t2；</span><br><span class="line">-- 写法2</span><br><span class="line">SELECT * from 表1 [AS] t1，表2 [AS] t2；</span><br></pre></td></tr></table></figure>
<p>但一般我们不这么用，与前面类似，自连接的使用一般搭配内连接和自然连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 写法1</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1 AS t1 [INNER] JOIN 表2 AS t2 ON 等值条件；</span><br><span class="line">-- 写法2</span><br><span class="line">SELECT 表1.*, 表2.不包含重复列的其他列 from 表1 AS t1，表2 AS t2 WHERE 等值条件；</span><br></pre></td></tr></table></figure>

<h2 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h2><p>之前我们提到所有的广义内连接是完全基于笛卡尔积的，即所有广义内连接的结果都能在笛卡尔积表里找到，内连接将一个表中的行与另一个表中的行相关联，但有时候需要包含没有关联行的那些行，这些行在是笛卡尔积中是不存在的，这时就要用到外连接了，即<strong>外连接不是完全基于笛卡尔积的</strong>。这可能听起来难以理解，我将举例子说明。</p>
<h3 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h3><p><strong>返回包括左表中的所有记录和右表中连接字段相等的记录</strong>。这个要求笛卡尔积表并不能满足。例如有两个表如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">员工表：</span><br><span class="line">    +----------+--------------+----------+</span><br><span class="line">    | 员工ID   | 员工名字     | 部门ID   |</span><br><span class="line">    +----------+--------------+----------+</span><br><span class="line">    | 1        | 张三         | 1        |</span><br><span class="line">    | 2        | 李四         | 2        |</span><br><span class="line">    | 3        | 王五         | NULL     |</span><br><span class="line">    +----------+--------------+----------+</span><br><span class="line">部门表：</span><br><span class="line">    +----------+--------------+</span><br><span class="line">    | 部门ID   | 部门名字     |</span><br><span class="line">    +----------+--------------+</span><br><span class="line">    | 1        | 销售部       |</span><br><span class="line">    | 2        | 财务部       |</span><br><span class="line">    +----------+--------------+</span><br></pre></td></tr></table></figure>
<p>假设这么一种情况，王五刚入职，还没有分配部门，这时领导要求查询所有员工的信息及所在的部门信息，包括未分配部门的员工。那这个要求在笛卡尔积表里能找到吗？<br>我们试一下内连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM emp [INNER] JOIN dep ON emp.&#96;员工ID&#96; &#x3D; dep.&#96;部门ID&#96;;</span><br><span class="line"></span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 员工ID   | 员工名字     | 部门ID   | 部门ID   | 部门名字     |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 1        | 张三         | 1        | 1        | 销售部       |</span><br><span class="line">| 2        | 李四         | 2        | 2        | 财务部       |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br></pre></td></tr></table></figure>
<p>好像不行，并不包括王五的记录啊，那我们看一下笛卡尔表里都有什么：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM emp [INNER] JOIN dep;</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 员工ID   | 员工名字     | 部门ID   | 部门ID   | 部门名字     |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 1        | 张三         | 1        | 1        | 销售部       |</span><br><span class="line">| 1        | 张三         | 1        | 2        | 财务部       |</span><br><span class="line">| 2        | 李四         | 2        | 1        | 销售部       |</span><br><span class="line">| 2        | 李四         | 2        | 2        | 财务部       |</span><br><span class="line">| 3        | 王五         | NULL     | 1        | 销售部       |</span><br><span class="line">| 3        | 王五         | NULL     | 2        | 财务部       |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br></pre></td></tr></table></figure>
<p>我们发现笛卡尔积表里并没有符合要求的记录，此时就要用到外连接了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM emp LEFT [OUTER] JOIN dep ON emp.&#96;员工ID&#96; &#x3D; dep.&#96;部门ID&#96;;</span><br><span class="line"></span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 员工ID   | 员工名字     | 部门ID   | 部门ID   | 部门名字     |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br><span class="line">| 1        | 张三         | 1        | 1        | 销售部       |</span><br><span class="line">| 2        | 李四         | 2        | 2        | 财务部       |</span><br><span class="line">| 3        | 王五         | NULL     | NULL     | NULL         |</span><br><span class="line">+----------+--------------+----------+----------+--------------+</span><br></pre></td></tr></table></figure>
<p>我们可以看到王五那条记录在笛卡尔积表是不存在的，这也是我们所说的<strong>外连接不是完全基于笛卡尔积的，左外连接会返回包括左表中的所有记录和右表中连接字段相等的记录（可以理解成外连接比内连接的记录更多，多了一边为null的记录）</strong>。</p>
<p>这存在一个隐式的条件，外连接可以没有条件吗？我们知道内连接没有条件会变成交叉连接，答案是外连接必须存在等值条件，不然这种连接就跟外连接的定义相违背，SQL也会报错。但是我们可以给一个恒为true的条件，这时外连接是否会就退化成内连接了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span> <span class="keyword">LEFT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> <span class="keyword">ON</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 等价于 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span>, 表<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>或者我们用逻辑查询处理的思路分析一下上面这种特殊情况，首先从from开始生成两个表的笛卡尔积，然后ON过滤，这里条件始终为true没有执行任何过滤，笛卡尔积中的所有记录都保留下来，然后到join中添加外部行，因为左边的边的记录都在，所以不需要添加外部行，所以这时就是笛卡尔积。</p>
<h3 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h3><p>跟左外连接原理完全相同，只不过返回包括右表中的所有记录和左表中连接字段相等的记录。其实掌握一个就行，左外连接中两个表互换位置就是右外连接了。语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * from RIGHT [OUTER] JOIN 表2 ON 等值条件；</span><br></pre></td></tr></table></figure>
<h3 id="全外连接"><a href="#全外连接" class="headerlink" title="全外连接"></a>全外连接</h3><p>返回左右表中所有的记录和左右表中连接字段相等的记录。<br>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * from FULL [OUTER] JOIN 表2 ON 等值条件；</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：FULL OUTER JOIN的支持： Access、MariaDB、MySQL、Open Office Base和SQLite不支持FULL OUTER JOIN语法</p>
</blockquote>
<h2 id="联结算法"><a href="#联结算法" class="headerlink" title="联结算法"></a>联结算法</h2><p>联接算法是MySQL数据库用于处理联接的物理策略。目前MySQL数据库仅支持Nested-Loops Join算法，这里只简单介绍一下这个联结算法。Nested-Loops Join算法有两种，分别为：</p>
<ul>
<li>Simple Nested-Loops Join算法</li>
<li>Block Nested-Loops Join算法</li>
</ul>
<h3 id="Simple-Nested-Loops-Join算法"><a href="#Simple-Nested-Loops-Join算法" class="headerlink" title="Simple Nested-Loops Join算法"></a>Simple Nested-Loops Join算法</h3><p>简单来说嵌套循环连接算法就是一个双层for循环，通过循环外层表的行数据，逐个与内层表的所有行数据进行比较来获取结果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for each row r in R do</span><br><span class="line">    for each row s in S do</span><br><span class="line">        if r and s satisfy the join condition</span><br><span class="line">            then output the tuple &lt;r,s&gt;</span><br></pre></td></tr></table></figure>
<p>所以这种算法的扫描成本为O（RnxSn），Rn和Sn分别代表R表和S表中分别含有的记录数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for each row r in R do</span><br><span class="line">    lookup r in S index</span><br><span class="line">        if found s &#x3D;&#x3D; r</span><br><span class="line">            then output the tuple &lt;r,s&gt;</span><br></pre></td></tr></table></figure>
<p>但是对于联接的列含有索引的情况，外部表的每条记录不再需要扫描整张内部表，只需要扫描内部表上的索引即可得到联接的判断结果。如果内部表联接列的索引高度为S<sub>BH</sub>，那么上述算法的扫描次数为Rn+S<sub>BH</sub>xRn，扫描成本为O（Rn）。而一般B+树的高度为3～4层，因此在有索引的情况下，Simple Nested-Loops Join算法的执行速度是比较快的。这种利用索引的Simple Nested-Loops Join算法也被称为Index Nested-Loops Join算法。</p>
<h3 id="Block-Nested-Loops-Join算法"><a href="#Block-Nested-Loops-Join算法" class="headerlink" title="Block Nested-Loops Join算法"></a>Block Nested-Loops Join算法</h3><p>但如果没有索引怎么办，而Block Nested-LoopsJoin算法就是针对没有索引的联接情况设计的，其使用Join Buffer（联接缓冲）来减少内部循环读取表的次数。例如加入外部表有100行，Block Nested-Loops Join算法会先把对Outer Loop表（外部表）每次读取的100行记录（准确地说是100行需要进行联接的列）放入Join Buffer中，然后在Inner Loop表（内部表）中直接匹配这100行数据。因此，对Inner Loop表的扫描减少到了原来的1/100。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">for each row in t1 matching range &#123;</span><br><span class="line">        for each row in t2 matching reference key &#123;</span><br><span class="line">        store used columns from t1, t2 in join buffer</span><br><span class="line">        if buffer is full &#123;</span><br><span class="line">                for each row in t3 &#123;</span><br><span class="line">                      for each t1, t2 combination in join buffer &#123;</span><br><span class="line">                              if row satisfies join conditions,</span><br><span class="line">                              send to client</span><br><span class="line">                      &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                empty buffer</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if buffer is not empty &#123;</span><br><span class="line">        for each row in t3 &#123;</span><br><span class="line">                for each t1, t2 combination in join buffer &#123;</span><br><span class="line">                      if row satisfies join conditions,</span><br><span class="line">                      send to client</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>MySQL数据库使用Join Buffer的原则如下：</p>
<ul>
<li>系统变量join_buffer_size决定了Join Buffer的大小。</li>
<li>Join Buffer可被用于联接是ALL、index和range的类型。</li>
<li>每次联接使用一个Join Buffer，因此多表的联接可以使用多个Join Buffer。</li>
<li>Join Buffer在联接发生之前进行分配，在SQL语句执行完后进行释放。</li>
<li>Join Buffer只存储需要进行查询操作的相关列数据，而不是整行的记录</li>
</ul>
<p>在EXPLAIN的extra中会显示<code>Using join buffer</code>，或者更详细<code>Using join buffer(Block Nested Loop)</code></p>
<p>当然还存在很多联结算法，例如Batched Key Access Join算法，Classic Hash Join算法有兴趣再去了解。</p>
<h3 id="Classic-Hash-Join算法"><a href="#Classic-Hash-Join算法" class="headerlink" title="Classic Hash Join算法"></a>Classic Hash Join算法</h3><p>我又来更新了，刚看到文档中说在8.0.20之后，不再支持block nested loop了。所以我们还是很有必要学习一下Hash Join算法。</p>
<blockquote>
<p>Beginning with MySQL 8.0.20, support for block nested loop is removed, and the server employs a hash join wherever a block nested loop would have been used previously.</p>
</blockquote>
<p>Classic Hash Join算法同样使用Join Buffer，先将外部表中数据放入Join Buffer中，然后根据键值产生一张散列表，这是第一个阶段，称为build阶段。随后读取内部表中的一条记录，对其应用散列函数，将其和散列表中的数据进行比较，这是第二个阶段，称为probe阶段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for each tuple r in R do</span><br><span class="line">    store used columns as p from R in join buffer</span><br><span class="line">    build hash table according join buffer</span><br><span class="line">    for each tuple s in R do</span><br><span class="line">        probe hash table</span><br><span class="line">        if find</span><br><span class="line">            then output the tuple &lt;p,s&gt;</span><br></pre></td></tr></table></figure>
<p>可见相比block nested loop其核心思想是将Join buffer中的数据组织成一张散列表，这样每次扫描buffer中记录的时间复杂度就降低到了常数级，但有几点需要知晓：</p>
<ul>
<li>Hash Join只能应用于等值的联接操作中，因为已通过散列函数生成新的联接值，不能将Hash Join用于非等值的联接操作中，但在 MySQL8.0.20 之后，这个限制不再绝对，一些不包含等值条件的语句也可以优化使用；</li>
<li>Hash Join不仅仅应用于没索引的情况，当有一个或多个索引可用于单表的情况下仍然可以使用。</li>
</ul>
<h2 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h2><ul>
<li>与联接操作一样，集合操作也是对两个输入进行操作，并生成一个虚拟表，有点类似于数学中的合并；</li>
<li>集合操作的两个输入必须拥有相同的列数，若数据类型不同，MySQL数据库会自动将进行隐式转化，并且结果列的名称由第一个输入决定；</li>
<li>若SELECT语句中包含LIMIT和ORDER BY子句，要为参与集合操作的各SELECT语句添加括号，否则执行集合查询会产生错误。</li>
</ul>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> x;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> y;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a <span class="keyword">as</span> m <span class="keyword">from</span> x</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">union</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> n <span class="keyword">from</span> dual</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">&#x27;abc&#x27;</span> <span class="keyword">as</span> o <span class="keyword">from</span> dual;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> m                   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> a                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> abc                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br></pre></td></tr></table></figure>
<h3 id="UNION-DISTINCT"><a href="#UNION-DISTINCT" class="headerlink" title="UNION [DISTINCT]"></a>UNION [DISTINCT]</h3><p>UNION DISTINCT组合两个输入，并应用DISTINCT过滤重复项。一般省略DISTINCT关键字，直接用UNION，例如</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> x</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">union</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> y;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>MySQL数据库目前对UNION DISTINCT的实现方式如下：</p>
<ul>
<li>创建一张临时表，即虚拟表。</li>
<li>对这张临时表的列添加唯一索引（Unique Index）。</li>
<li>将输入的数据插入临时表。</li>
<li>返回虚拟表。</li>
</ul>
<h3 id="UNION-ALL"><a href="#UNION-ALL" class="headerlink" title="UNION ALL"></a>UNION ALL</h3><p>UNION ALL组合两个输入中所有项的结果集，并包含重复的选项，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> x</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> y;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> c    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>对于其他的集合操作，例如EXCEPT和INTERSECT只能通过组合SQL语句实现，有兴趣的小伙伴可以深入研究一下。</p>
<blockquote>
<p>ref:</p>
<ol>
<li>《MySQL技术内幕：SQL编程》</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/54275505">Mysql Join算法原理</a></li>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/">MySQL 8.0 Reference Manual</a></li>
</ol>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF/" rel="tag"><i class="fa fa-tag"></i> 笛卡尔积</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/02/09/MySQL04_EXPLAIN%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/" rel="prev" title="EXPLAIN性能分析">
                  <i class="fa fa-chevron-left"></i> EXPLAIN性能分析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/02/27/MySQL06_MySQL%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F/" rel="next" title="MySQL中的变量">
                  MySQL中的变量 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>





<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Saltedfish</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">555k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16:48</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
